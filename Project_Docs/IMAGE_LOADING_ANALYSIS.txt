이미지 로딩 경로 및 로컬/서버 참조 미스터리 분석 보고서
==================================================

작성일: 2026-02-12
작성자: Antigravity AI

1. 현상 요약
-----------
로컬 개발 환경(localhost:3500)에서 Vite 프록시 설정이 localhost:8500(로컬 백엔드)을 가리키고 있고,
로컬 폴더(uploads/danger_zones/...)에는 해당 이미지 파일이 존재하지 않음에도 불구하고,
브라우저 대시보드에서 이미지가 200 OK로 정상 로드되는 현상이 발생함.

2. 기술적 분석 및 추정 원인
-----------------------
분석 결과, 다음과 같은 경로로 이미지가 로드되었을 가능성이 매우 높음:

A. Vite 프록시 설정의 혼선 (가장 유력)
   - 이전에 vite.config.js에서 target을 서버 IP(168.107.52.201)로 설정했던 적이 있음.
   - Vite 개발 서버는 파일을 수정해도 프록시 설정을 메모리에 유지하거나, 브라우저가 이전 프록시 경로를 캐싱하고 있었을 가능성.
   - 결과적으로 브라우저는 localhost:3500/uploads/...를 호출했지만, Vite가 이를 서버 백엔드로 전달함.

B. 브라우저 강력 캐시 (304 Not Modified)
   - Network 탭 확인 결과 많은 이미지가 304 또는 (from disk cache) 상태였음.
   - 설정을 바꾸기 전에 서버에서 한 번이라도 불러온 이미지는 로컬 백엔드가 꺼져 있거나 파일이 없어도 브라우저가 기존 이미지를 보여줌.

C. 백엔드 CORS 및 포트 포워딩
   - 로컬 백엔드가 서버 DB를 참조하고 있는 상태에서, 특정 헤더나 요청이 서버 IP로 리다이렉트되었을 가능성.

3. 향후 조치 및 권장 사항
-----------------------
- 로컬 개발 시 명확하게 '로컬 파일'만 보고 싶다면, 브라우저 개발자 도구(F12)의 'Disable Cache'를 체크한 상태로 개발 권장.
- 이미지 저장 구조를 Flat 구조(uploads/daily_danger_images/)로 변경하여 경로 유추 과정의 복잡성을 제거함 (완료 예정).
- 로컬과 서버의 데이터(DB)를 동기화하거나, 아예 개발 시에도 이미지 서버(서버 백엔드)를 명시적으로 참조하도록 설정하는 것이 정신 건강에 이로움.

==================================================
